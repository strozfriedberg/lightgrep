#include <scope/test.h>

#include "fieldhasher.h"

SCOPE_TEST(testHash) {
  const FieldHash exp{{
    0xda, 0x6f, 0x31, 0x76, 0xd3, 0x20, 0x1e, 0x53,
    0x7e, 0xb2, 0x02, 0xb2, 0x54, 0x4c, 0x63, 0x72,
    0x4f, 0xca, 0x00, 0xd5, 0x47, 0x46, 0x65, 0x08,
    0x11, 0x2c, 0x4f, 0x79, 0xef, 0xe8, 0x00, 0xf3
  }};

  FieldHasher hasher;

  // piecewise
  hasher.hash_it(1);
  hasher.hash_it(26);
  hasher.hash_it("foo");
  SCOPE_ASSERT_EQUAL(exp, hasher.get_hash());

  // all in one go
  SCOPE_ASSERT_EQUAL(exp, hasher.hash(1, 26, "foo"));
}
